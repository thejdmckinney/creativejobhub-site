<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PHMP7P59');</script>
  <!-- End Google Tag Manager -->
  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HubSpot Private App Setup - Creative Job Hub</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            color: #1f2937;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #ff7a00;
            margin-bottom: 10px;
        }

        .step-panel {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .step-number {
            background: linear-gradient(135deg, #ff7a00, #ff9500);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .step-title {
            font-size: 1.5rem;
            color: #f1f5f9;
        }

        .code-block {
            background: #0f172a;
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        .warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #fbbf24;
        }

        .info {
            background: rgba(14, 165, 233, 0.1);
            border: 1px solid rgba(14, 165, 233, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #34d399;
        }

        .btn {
            background: linear-gradient(135deg, #ff7a00, #ff9500);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            display: inline-block;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 122, 0, 0.3);
        }

        .permission-list {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .permission-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }

        .permission-item:last-child {
            border-bottom: none;
        }

        .permission-name {
            flex: 1;
            font-weight: 600;
            color: #ff6b35;
        }

        .permission-desc {
            flex: 2;
            color: #6b7280;
            font-size: 0.9rem;
        }

        .config-form {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #f1f5f9;
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(148, 163, 184, 0.3);
            border-radius: 6px;
            background: rgba(30, 41, 59, 0.8);
            color: #1f2937;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        .form-input:focus {
            outline: none;
            border-color: #ff7a00;
            box-shadow: 0 0 0 2px rgba(255, 122, 0, 0.2);
        }
    </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PHMP7P59"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
    <div class="container">
        <div class="header">
            <h1>üîß HubSpot Private App Setup</h1>
            <p>Complete guide to create and configure your HubSpot private app integration</p>
        </div>

        <!-- Step 1: Create Private App -->
        <div class="step-panel">
            <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Create Private App in HubSpot</div>
            </div>
            
            <div class="info">
                <strong>üìã What you'll need:</strong> HubSpot account with developer/admin access
            </div>
            
            <ol style="padding-left: 20px; line-height: 1.8;">
                <li>Go to your HubSpot account</li>
                <li>Navigate to <strong>Settings</strong> (gear icon) ‚Üí <strong>Integrations</strong> ‚Üí <strong>Private Apps</strong></li>
                <li>Click <strong>"Create a private app"</strong></li>
                <li>Fill in the <strong>Basic Info</strong>:
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>App name:</strong> Creative Job Hub Integration</li>
                        <li><strong>Description:</strong> Website analytics and lead management integration</li>
                    </ul>
                </li>
            </ol>

            <a href="https://app.hubspot.com/settings/integrations/private-apps" target="_blank" class="btn">
                üöÄ Create Private App
            </a>
        </div>

        <!-- Step 2: Configure Scopes -->
        <div class="step-panel">
            <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">Configure Required Scopes</div>
            </div>
            
            <p style="margin-bottom: 20px;">In the <strong>Scopes</strong> tab, enable these permissions:</p>
            
            <div class="permission-list">
                <div class="permission-item">
                    <div class="permission-name">crm.objects.contacts.read</div>
                    <div class="permission-desc">Read contact data for lead tracking</div>
                </div>
                <div class="permission-item">
                    <div class="permission-name">crm.objects.deals.read</div>
                    <div class="permission-desc">Read deal pipeline for conversion analytics</div>
                </div>
                <div class="permission-item">
                    <div class="permission-name">crm.objects.companies.read</div>
                    <div class="permission-desc">Read company information</div>
                </div>
                <div class="permission-item">
                    <div class="permission-name">crm.lists.read</div>
                    <div class="permission-desc">Access contact lists and segments</div>
                </div>
                <div class="permission-item">
                    <div class="permission-name">reports</div>
                    <div class="permission-desc">Generate analytics reports</div>
                </div>
            </div>

            <div class="warning">
                <strong>‚ö†Ô∏è Important:</strong> Only select the scopes you actually need. You can always add more later.
            </div>
        </div>

        <!-- Step 3: Get Access Token -->
        <div class="step-panel">
            <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">Generate Access Token</div>
            </div>
            
            <ol style="padding-left: 20px; line-height: 1.8;">
                <li>Click <strong>"Create app"</strong> after configuring scopes</li>
                <li>Go to the <strong>"Auth"</strong> tab of your newly created app</li>
                <li>Click <strong>"Generate token"</strong></li>
                <li>Copy the access token (starts with <code>pat-na1-</code> or similar)</li>
            </ol>

            <div class="warning">
                <strong>üîí Security Note:</strong> Store this token securely! It gives access to your HubSpot data. Never commit it to public repositories.
            </div>
        </div>

        <!-- Step 4: Configure Integration -->
        <div class="step-panel">
            <div class="step-header">
                <div class="step-number">4</div>
                <div class="step-title">Configure Your Integration</div>
            </div>
            
            <p style="margin-bottom: 20px;">Enter your HubSpot credentials to test the integration:</p>
            
            <div class="config-form">
                <div class="form-group">
                    <label class="form-label" for="accessToken">Private App Access Token</label>
                    <input 
                        type="password" 
                        id="accessToken" 
                        class="form-input" 
                        placeholder="pat-na1-xxxxxxxxxx-xxxxxxxx-xxxxxxxx-xxxxxxxx"
                    >
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="portalId">Portal/Hub ID (Optional)</label>
                    <input 
                        type="text" 
                        id="portalId" 
                        class="form-input" 
                        placeholder="12345678 (found in HubSpot URL)"
                    >
                </div>
                
                <button onclick="testConnection()" class="btn">
                    üîó Test Connection
                </button>
                
                <button onclick="saveConfiguration()" class="btn">
                    üíæ Save Configuration
                </button>
            </div>

            <div id="connectionResult" style="margin-top: 20px;"></div>
        </div>

        <!-- Step 5: Implementation -->
        <div class="step-panel">
            <div class="step-header">
                <div class="step-number">5</div>
                <div class="step-title">Updated Integration Code</div>
            </div>
            
            <p style="margin-bottom: 15px;">Your integration code has been updated to use the new private app authentication:</p>
            
            <div class="code-block">
// Modern HubSpot Private App Integration
class HubSpotConnector {
    constructor(accessToken, portalId = null) {
        this.accessToken = accessToken;
        this.portalId = portalId;
        this.baseUrl = 'https://api.hubapi.com';
        this.headers = {
            'Authorization': `Bearer ${this.accessToken}`,
            'Content-Type': 'application/json'
        };
    }

    async fetchContacts(limit = 100) {
        const url = `${this.baseUrl}/crm/v3/objects/contacts`;
        const response = await fetch(`${url}?limit=${limit}`, {
            headers: this.headers
        });
        
        if (!response.ok) {
            throw new Error(`HubSpot API error: ${response.status}`);
        }
        
        return response.json();
    }

    async fetchDeals(limit = 100) {
        const url = `${this.baseUrl}/crm/v3/objects/deals`;
        const response = await fetch(`${url}?limit=${limit}`, {
            headers: this.headers
        });
        
        if (!response.ok) {
            throw new Error(`HubSpot API error: ${response.status}`);
        }
        
        return response.json();
    }
}
            </div>

            <div class="success">
                <strong>‚úÖ Ready to Go!</strong> Your integration now uses modern HubSpot private app authentication with proper security.
            </div>
        </div>

        <!-- Step 6: Testing -->
        <div class="step-panel">
            <div class="step-header">
                <div class="step-number">6</div>
                <div class="step-title">Test & Deploy</div>
            </div>
            
            <ol style="padding-left: 20px; line-height: 1.8;">
                <li>Use the connection test above to verify your credentials</li>
                <li>Check the browser console for any API errors</li>
                <li>Visit your business dashboard to see live HubSpot data</li>
                <li>Monitor API usage in your HubSpot private app settings</li>
            </ol>

            <a href="../admin/business-dashboard.html" class="btn">
                üìä View Business Dashboard
            </a>
            
            <a href="../admin/data-setup.html" class="btn">
                ‚öôÔ∏è Data Configuration
            </a>
        </div>
    </div>

    <script>
        // Test HubSpot connection
        async function testConnection() {
            const accessToken = document.getElementById('accessToken').value;
            const resultDiv = document.getElementById('connectionResult');
            
            if (!accessToken) {
                resultDiv.innerHTML = `
                    <div class="warning">
                        ‚ö†Ô∏è Please enter your private app access token
                    </div>
                `;
                return;
            }

            resultDiv.innerHTML = `
                <div class="info">
                    üîÑ Testing connection to HubSpot...
                </div>
            `;

            try {
                const response = await fetch('https://api.hubapi.com/crm/v3/objects/contacts?limit=1', {
                    headers: {
                        'Authorization': `Bearer ${accessToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `
                        <div class="success">
                            ‚úÖ <strong>Connection successful!</strong><br>
                            Found ${data.total || 0} contacts in your HubSpot account.
                        </div>
                    `;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="warning">
                        ‚ùå <strong>Connection failed:</strong><br>
                        ${error.message}<br><br>
                        <strong>Common issues:</strong><br>
                        ‚Ä¢ Invalid access token<br>
                        ‚Ä¢ Missing required scopes<br>
                        ‚Ä¢ CORS policy (test in actual dashboard)
                    </div>
                `;
            }
        }

        // Save configuration to localStorage
        function saveConfiguration() {
            const accessToken = document.getElementById('accessToken').value;
            const portalId = document.getElementById('portalId').value;
            const resultDiv = document.getElementById('connectionResult');
            
            if (!accessToken) {
                resultDiv.innerHTML = `
                    <div class="warning">
                        ‚ö†Ô∏è Please enter your private app access token
                    </div>
                `;
                return;
            }

            // Save to localStorage (in production, use secure storage)
            localStorage.setItem('hubspot_config', JSON.stringify({
                accessToken: accessToken,
                portalId: portalId || null,
                configuredAt: new Date().toISOString()
            }));

            resultDiv.innerHTML = `
                <div class="success">
                    ‚úÖ <strong>Configuration saved!</strong><br>
                    Your HubSpot integration is ready to use.
                </div>
            `;

            // Clear the form for security
            setTimeout(() => {
                document.getElementById('accessToken').value = '';
                document.getElementById('portalId').value = '';
            }, 3000);
        }

        // Load existing configuration
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('hubspot_config');
            if (saved) {
                try {
                    const config = JSON.parse(saved);
                    if (config.portalId) {
                        document.getElementById('portalId').value = config.portalId;
                    }
                    
                    document.getElementById('connectionResult').innerHTML = `
                        <div class="info">
                            üìã <strong>Existing configuration found</strong><br>
                            Configured on: ${new Date(config.configuredAt).toLocaleDateString()}<br>
                            Enter your access token to test or update.
                        </div>
                    `;
                } catch (e) {
                    console.error('Error loading saved config:', e);
                }
            }
        });
    </script>
</body>
</html>